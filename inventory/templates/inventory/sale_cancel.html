{% extends 'inventory/base.html' %}

{% block title %}删除销售单 - {{ block.super }}{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6">
        <div class="card shadow-sm">
            <div class="card-header bg-danger text-white">
                <h4 class="mb-0">删除销售单 #{{ sale.id }}</h4>
            </div>
            <div class="card-body">
                {% if sale.status == 'UNSETTLED' %}
                <p class="text-muted mb-3">
                    未结算订单执行此操作后会标记为“已放弃”，定金会继续保留在销售额统计中，
                    且不会扣减库存。
                </p>
                {% else %}
                <p class="text-muted mb-3">
                    删除后该销售单会标记为“已删除”，并同步回滚业务数据：
                    已完成订单会恢复库存，订单金额将不再计入销售统计。
                </p>
                {% endif %}
                <form method="post">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="reason" class="form-label">删除原因</label>
                        <textarea
                            class="form-control"
                            id="reason"
                            name="reason"
                            rows="4"
                            placeholder="请输入删除原因（可选）"
                        ></textarea>
                    </div>
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-danger">确认删除并回滚</button>
                        <a href="{% url 'sale_detail' sale.id %}" class="btn btn-outline-secondary">返回详情</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}
